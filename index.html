<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>·ª®ng d·ª•ng T√≠nh To√°n Doanh Thu Shopee & TikTok</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
<style>
    .platform-btn {
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.2s ease;
        box-shadow: 0 4px 16px 0 rgba(0,0,0,0.10), 0 1.5px 0 0 #e5e7eb;
        border: 2px solid #e5e7eb;
        background: #f3f4f6;
        position: relative;
    }
    .platform-btn:active {
        top: 2px;
        box-shadow: 0 2px 8px 0 rgba(0,0,0,0.10);
    }
    .platform-btn.selected {
        box-shadow: 0 8px 24px 0 rgba(0,0,0,0.18), 0 2px 0 0 #d97706;
        border-color: #d97706;
        z-index: 1;
    }

  .toggle-btn {
    display: inline-block;
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    border: 2px solid #e5e7eb;
    background-color: #f3f4f6;
    color: #374151;
    font-weight: 500;
    cursor: pointer;
    transition: 0.2s;
    user-select: none;
  }

  /* Khi checkbox ƒë∆∞·ª£c tick ‚Üí t√¥ ƒëen */
  input[type="checkbox"]:checked + label.toggle-btn {
    background-color: black;
    color: white;
    border-color: black;
  }

.day-btn {
  padding: 0.6rem 1.25rem;
  border-radius: 0.5rem;
  font-weight: 500;
  font-size: 0.95rem;
  border: 2px solid #e5e7eb;
  background: #f3f4f6;
  color: #374151;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.05);
}
.day-btn.active {
  background: #000;
  color: white;
  border-color: #000;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18);
}

  .select-btn {
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    background: #f3f4f6;
    border: 2px solid #e5e7eb;
    color: #374151;
    font-weight: 500;
    cursor: pointer;
    transition: 0.2s;
  }
  .select-btn.active {
    background: black;
    color: white;
    border-color: black;
  }
</style>

</head>

<body class="bg-gray-50 min-h-screen py-8">
    <div class="max-w-7xl mx-auto px-4">
        <!-- Header -->
<div class="text-center mb-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">
        <i class="fas fa-calculator mr-3"></i>
        T√≠nh To√°n Doanh Thu & L·ª£i Nhu·∫≠n
    </h1>

    <div class="flex justify-center items-center space-x-2 text-gray-700 text-sm">
        <span class="text-base font-semibold">Ng√†nh h√†ng:</span>

        <button class="px-3 py-1 bg-gray-200 rounded-full font-medium hover:bg-gray-300 transition">Th·ª±c ph·∫©m v√† ƒë·ªì u·ªëng</button>

        <!-- D·∫§U ‚Üí D·∫†NG N√öT -->
        <span>‚Üí</span>

        <button class="px-3 py-1 bg-gray-200 rounded-full font-medium hover:bg-gray-300 transition">ƒê·ªì u·ªëng</button>
    </div>
</div>


        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Left Column - Input -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-gray-200">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">
                    <i class="fas fa-edit mr-2"></i>Nh·∫≠p Th√¥ng Tin
                </h2>

                <!-- Platform Selection -->
<div class="mb-6">
    <label class="block text-sm font-medium text-gray-700 mb-3">Ch·ªçn s√†n b√°n h√†ng</label>
    <div class="flex space-x-4">
        <button id="shopee-btn" class="platform-btn bg-gray-300 text-gray-700 hover:bg-gray-400">
            <i class="fas fa-shopping-bag"></i>
            <span>Shopee</span>
        </button>
        <button id="tiktok-btn" class="platform-btn bg-gray-300 text-gray-700 hover:bg-gray-400">
            <i class="fab fa-tiktok"></i>
            <span>TikTok</span>
        </button>
    </div>
</div>

                <!-- Basic Input Fields -->
                <div class="space-y-4 mb-6">
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Gi√° b√°n s·∫£n ph·∫©m (Ngh√¨n .ƒë)</label>
                        <input type="number" id="sell-price" min="0" class="w-full pr-16 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0">
                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none select-none">.000ƒë</span>
                    </div>
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Gi√° nh·∫≠p s·∫£n ph·∫©m (Ngh√¨n .ƒë)</label>
                        <input type="number" id="cost-price" min="0" class="w-full pr-16 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0">
                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none select-none">.000ƒë</span>
                    </div>
                    <div class="relative">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Voucher gi·∫£m gi√° (Ngh√¨n .ƒë)</label>
                        <input type="number" id="voucher" min="0" class="w-full pr-16 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="0">
                        <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none select-none">.000ƒë</span>
                    </div>

<div class="relative">
    <label class="block text-sm font-medium text-gray-700 mb-2">S·ªë ƒë∆°n d·ª± ki·∫øn</label>
    <input type="number" id="order-count" min="1" value="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="1">
</div>

                </div>

<div id="shopee-xtra-options" class="mb-6 hidden">
  <label class="block text-sm font-medium text-gray-700 mb-3">Ch·ªçn c√°c ch∆∞∆°ng tr√¨nh ƒë√£ ƒëƒÉng k√Ω:</label>
  <div class="flex space-x-4">
    <input type="checkbox" id="voucher-xtra" class="hidden">
    <label for="voucher-xtra" class="toggle-btn">Voucher Xtra</label>

    <input type="checkbox" id="content-xtra" class="hidden">
    <label for="content-xtra" class="toggle-btn">Content Xtra</label>
  </div>
</div>


                <!-- TikTok Day Type Selection -->
<div id="tiktok-xtra-options" class="mb-6 hidden">
  <label class="block text-sm font-medium text-gray-700 mb-3">Ch·ªçn c√°c ch∆∞∆°ng tr√¨nh ƒë√£ ƒëƒÉng k√Ω:</label>
  <div class="flex space-x-4">
    <input type="checkbox" id="tiktok-voucher-xtra" class="hidden">
    <label for="tiktok-voucher-xtra" class="toggle-btn">Voucher Extra</label>
  </div>
</div>

<div id="tiktok-day-type" class="mb-6 hidden">
  <label class="block text-sm font-medium text-gray-700 mb-3">Ph√≠ Voucher Extra</label>
  <div class="flex space-x-4">
    
<input type="radio" name="day-type" id="day-normal" value="normal" class="hidden" checked>
<label for="day-normal" class="day-btn active day">Ng√†y th∆∞·ªùng (2%)</label>

<input type="radio" name="day-type" id="day-sale" value="sale" class="hidden">
<label for="day-sale" class="day-btn">Ng√†y sale (3%)</label>


  </div>
</div>

                <!-- Customizable Fees -->
                <div class="border-t pt-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">
                        <i class="fas fa-cog mr-2"></i>Ph√≠ v·∫≠n h√†nh (c√≥ th·ªÉ t√πy ch·ªânh)
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">L∆∞∆°ng nh√¢n vi√™n (%)</label>
                            <input type="number" id="salary-fee" value="30" step="5" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Qu·∫£ng c√°o (%)</label>
                            <input type="number" id="ads-fee" value="15" step="5" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ti·∫øp th·ªã li√™n k·∫øt (%)</label>
                            <input type="number" id="affiliate-fee" value="15" step="5" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Results -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-gray-200">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">
                    <i class="fas fa-chart-line mr-2"></i>K·∫øt Qu·∫£ T√≠nh To√°n
                </h2>

                <!-- Results Display -->
                 
                <div class="space-y-4">
                    <div class="bg-gray-50 p-4 rounded-lg border-2 border-gray-200">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">T·ªïng ph√≠ n·ªÅn t·∫£ng:</span>
                            <span id="platform-fee" class="text-lg font-semibold text-red-600">0 ƒë</span>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg border-2 border-gray-200">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">T·ªïng ph√≠ v·∫≠n h√†nh:</span>
                            <span id="operation-fee" class="text-lg font-semibold text-red-600">0 ƒë</span>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 p-4 rounded-lg border-2 border-blue-200">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Doanh thu th·ª±c nh·∫≠n:</span>
                            <span id="net-revenue" class="text-xl font-bold text-blue-600">0 ƒë</span>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">L·ª£i nhu·∫≠n:</span>
                            <span id="profit" class="text-xl font-bold text-green-600">0 ƒë</span>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 p-4 rounded-lg border-2 border-red-200 shadow-sm">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">T·ª∑ l·ªá ph√≠ n·ªÅn t·∫£ng:</span>
                            <span id="platform-fee-ratio" class="text-lg font-semibold text-yellow-600">0%</span>
                        </div>
                        <div class="flex justify-between items-center mt-1">
                            <span class="text-sm font-medium text-gray-700">T·ª∑ l·ªá ph√≠ v·∫≠n h√†nh:</span>
                            <span id="operation-fee-ratio" class="text-lg font-semibold text-yellow-600">0%</span>
                        </div>
                    </div>

                </div>

                <!-- Fee Breakdown -->
                <div class="mt-8 border-t pt-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">
                        <i class="fas fa-list-ul mr-2"></i>Chi ti·∫øt ph√≠
                    </h3>
                    <div id="fee-breakdown" class="space-y-2 text-sm text-gray-600">
                        <!-- Fee breakdown will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-12 text-gray-500">
¬© 2025 ·ª®ng d·ª•ng T√≠nh To√°n Doanh Thu.<br>
  Phi√™n b·∫£n 1.0<br>
  Made by <a href="https://hieu.is-a.dev" target="_blank" style="color: #2563eb; text-decoration: underline;">MinhHieu</a>
        </div>
    </div>

    <script>
        let currentPlatform = 'shopee';
        
        // Platform selection
        document.getElementById('shopee-btn').addEventListener('click', () => {
            selectPlatform('shopee');
        });
        
        document.getElementById('tiktok-btn').addEventListener('click', () => {
            selectPlatform('tiktok');
        });
        
function selectPlatform(platform) {
    currentPlatform = platform;

    const shopeeBtn = document.getElementById('shopee-btn');
    const tiktokBtn = document.getElementById('tiktok-btn');
    const tiktokDayType = document.getElementById('tiktok-day-type');

    // Reset style cho c·∫£ hai
    shopeeBtn.classList.remove('selected');
    tiktokBtn.classList.remove('selected');
    shopeeBtn.classList.remove('bg-orange-500', 'text-white');
    tiktokBtn.classList.remove('bg-black', 'text-white');

    if (platform === 'shopee') {
        shopeeBtn.classList.add('selected', 'bg-orange-500', 'text-white');
        tiktokDayType.classList.add('hidden');
        document.getElementById('affiliate-fee').value = 15;
    } else {
        tiktokBtn.classList.add('selected', 'bg-black', 'text-white');
// Khi ch·ªçn TikTok
if (platform === 'shopee') {
  document.getElementById('shopee-xtra-options').classList.remove('hidden');
  document.getElementById('tiktok-xtra-options').classList.add('hidden');
  tiktokDayType.classList.add('hidden'); // ·∫©n lu√¥n ph·∫ßn ng√†y
} else {
  document.getElementById('shopee-xtra-options').classList.add('hidden');
  document.getElementById('tiktok-xtra-options').classList.remove('hidden');

  // üëá CH·ªà hi·ªán ph·∫ßn ch·ªçn ng√†y n·∫øu voucher xtra ƒë∆∞·ª£c t√≠ch
  if (document.getElementById('tiktok-voucher-xtra')?.checked) {
    tiktokDayType.classList.remove('hidden');
  } else {
    tiktokDayType.classList.add('hidden');
  }
}
        document.getElementById('affiliate-fee').value = 15;
    }

    const radioButtons = document.querySelectorAll('input[name="day-type"]');
const labels = document.querySelectorAll('.day-btn');

radioButtons.forEach((radio) => {
  radio.addEventListener('change', () => {
    labels.forEach((label) => label.classList.remove('active'));
    document.querySelector(`label[for="${radio.id}"]`).classList.add('active');
  });
});

if (platform === 'shopee') {
  document.getElementById('shopee-xtra-options').classList.remove('hidden');
  document.getElementById('tiktok-xtra-options').classList.add('hidden');
} else {
  document.getElementById('shopee-xtra-options').classList.add('hidden');
  document.getElementById('tiktok-xtra-options').classList.remove('hidden');
}

const isVoucherXtraChecked = document.getElementById('voucher-xtra').checked;
const isContentXtraChecked = document.getElementById('content-xtra').checked;

    calculateResult();
}
        
        // Input event listeners
const inputs = ['sell-price', 'cost-price', 'voucher', 'salary-fee', 'ads-fee', 'affiliate-fee', 'order-count'];
        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', calculateResult);
        });
        
        // Radio button event listener for TikTok day type
        document.querySelectorAll('input[name="day-type"]').forEach(radio => {
            radio.addEventListener('change', calculateResult);
        });
        
        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN').format(amount);
        }
        
function getRatioColorClass(ratio) {
    if (ratio > 50) return 'text-red-600';
    if (ratio < 10) return 'text-green-600';
    return 'text-yellow-600';
}

        function calculateResult() {
            const sellPrice = (parseFloat(document.getElementById('sell-price').value) || 0) * 1000;
            const costPrice = (parseFloat(document.getElementById('cost-price').value) || 0) * 1000;
            const voucher = (parseFloat(document.getElementById('voucher').value) || 0) * 1000;
            const orderCount = parseInt(document.getElementById('order-count').value) || 1;
            const salaryFee = parseFloat(document.getElementById('salary-fee').value) || 0;
            const adsFee = parseFloat(document.getElementById('ads-fee').value) || 0;
            const affiliateFee = parseFloat(document.getElementById('affiliate-fee').value) || 0;
            
const isVoucherXtraChecked = document.getElementById('voucher-xtra')?.checked;
const isContentXtraChecked = document.getElementById('content-xtra')?.checked;
const isTiktokVoucherXtraChecked = document.getElementById('tiktok-voucher-xtra')?.checked;
const gi√°SauVoucher = (sellPrice - voucher) * orderCount;  // üëà chuy·ªÉn l√™n ƒë√¢y


if (currentPlatform === 'shopee') {
  if (isVoucherXtraChecked) {
    // t√≠nh ph√≠ voucherXtra, KH√îNG c·ªông th√™m contentXtra
  } else if (isContentXtraChecked) {
    // t√≠nh ph√≠ contentXtra, KH√îNG c·ªông th√™m voucherXtra
  } else {
    // kh√¥ng t√≠nh th√™m ph√≠ n√†o
  }
}

            if (sellPrice <= 0) {
                resetResults();
                return;
            }
            
            let platformFeeDetails = [];
            let operationFeeDetails = [];
            let totalPlatformFee = 0;
            let totalOperationFee = 0;
            
            if (currentPlatform === 'shopee') {
                // Shopee platform fees
                const paymentFee = (gi√°SauVoucher) * 0.0491;
                const fixedFee = (gi√°SauVoucher) * 0.0884;
const voucherXtra = (gi√°SauVoucher) * 0.03;
const contentXtra = (gi√°SauVoucher) * 0.0295;
const infrastructureFee = 3000;
const pishipFee = 1650;



totalPlatformFee = paymentFee + fixedFee + infrastructureFee + pishipFee;

platformFeeDetails = [
    `Ph√≠ thanh to√°n (4.91%): ${formatCurrency(paymentFee)} ƒë`,
    `Ph√≠ c·ªë ƒë·ªãnh (8.84%): ${formatCurrency(fixedFee)} ƒë`
];

if (isVoucherXtraChecked && isContentXtraChecked) {
    // T√≠nh ph√≠: ch·ªâ c·ªông ph√≠ Voucher Xtra (nh∆∞ hi·ªán t·∫°i)
    totalPlatformFee += voucherXtra;

    // Hi·ªÉn th·ªã c·∫£ 2 ph√≠
    platformFeeDetails.push(
        `Voucher Xtra (3%): ${formatCurrency(voucherXtra)} ƒë`,
        `Content Xtra (2.95%): ${formatCurrency(contentXtra)} ƒë`
    );
} else if (isVoucherXtraChecked) {
    totalPlatformFee += voucherXtra;
    platformFeeDetails.push(`Voucher Xtra (3%): ${formatCurrency(voucherXtra)} ƒë`);
} else if (isContentXtraChecked) {
    totalPlatformFee += contentXtra;
    platformFeeDetails.push(`Content Xtra (2.95%): ${formatCurrency(contentXtra)} ƒë`);
}



platformFeeDetails.push(
    `Ph√≠ h·∫° t·∫ßng: ${formatCurrency(infrastructureFee)} ƒë`,
    `PiShip: ${formatCurrency(pishipFee)} ƒë`
);

                
                // Shopee operation fees
                const adsFeeAmount = (gi√°SauVoucher) * (adsFee / 100);
                const affiliateFeeAmount = (gi√°SauVoucher) * (affiliateFee / 100);
                const taxFee = (gi√°SauVoucher) * 0.015;
                const packagingFee = (gi√°SauVoucher) * 0.025;
                const otherFee = (gi√°SauVoucher) * 0.02;
                const salaryFeeAmount = (gi√°SauVoucher) * (salaryFee / 100);
                
                totalOperationFee = adsFeeAmount + affiliateFeeAmount + taxFee + packagingFee + otherFee + salaryFeeAmount;
                
                operationFeeDetails = [
                    `Qu·∫£ng c√°o (${adsFee}%): ${formatCurrency(adsFeeAmount)} ƒë`,
                    `Ti·∫øp th·ªã li√™n k·∫øt (${affiliateFee}%): ${formatCurrency(affiliateFeeAmount)} ƒë`,
                    `Thu·∫ø TNCN (1.5%): ${formatCurrency(taxFee)} ƒë`,
                    `ƒê√≥ng g√≥i (2.5%): ${formatCurrency(packagingFee)} ƒë`,
                    `Chi ph√≠ kh√°c (2%): ${formatCurrency(otherFee)} ƒë`,
                    `L∆∞∆°ng nh√¢n vi√™n (${salaryFee}%): ${formatCurrency(salaryFeeAmount)} ƒë`
                ];
                
            } else {
                // TikTok platform fees
                const transactionFee = (gi√°SauVoucher) * 0.05;
                const commissionFee = (gi√°SauVoucher) * 0.10;
                
                const dayType = document.querySelector('input[name="day-type"]:checked').value;
                const voucherExtraRate = dayType === 'normal' ? 0.02 : 0.03;
let voucherExtra = 0;
const isTiktokVoucherXtraChecked = document.getElementById('tiktok-voucher-xtra')?.checked;
if (isTiktokVoucherXtraChecked) {
    voucherExtra = (sellPrice - voucher) * voucherExtraRate;
}
totalPlatformFee = transactionFee + commissionFee + voucherExtra;

                
platformFeeDetails = [
    `Ph√≠ giao d·ªãch (5%): ${formatCurrency(transactionFee)} ƒë`,
    `Ph√≠ hoa h·ªìng n·ªÅn t·∫£ng (10%): ${formatCurrency(commissionFee)} ƒë`
];

if (isTiktokVoucherXtraChecked) {
    platformFeeDetails.push(`Voucher Extra Program (${voucherExtraRate * 100}%): ${formatCurrency(voucherExtra)} ƒë`);
}

                
                // TikTok operation fees (same as Shopee)
                const adsFeeAmount = (gi√°SauVoucher) * (adsFee / 100);
                const affiliateFeeAmount = (gi√°SauVoucher) * (affiliateFee / 100);
                const taxFee = (gi√°SauVoucher) * 0.015;
                const packagingFee = (gi√°SauVoucher) * 0.025;
                const otherFee = (gi√°SauVoucher) * 0.02;
                const salaryFeeAmount = (gi√°SauVoucher) * (salaryFee / 100);
                
                totalOperationFee = adsFeeAmount + affiliateFeeAmount + taxFee + packagingFee + otherFee + salaryFeeAmount;
                
                operationFeeDetails = [
                    `Qu·∫£ng c√°o (${adsFee}%): ${formatCurrency(adsFeeAmount)} ƒë`,
                    `Ti·∫øp th·ªã li√™n k·∫øt (${affiliateFee}%): ${formatCurrency(affiliateFeeAmount)} ƒë`,
                    `Thu·∫ø TNCN (1.5%): ${formatCurrency(taxFee)} ƒë`,
                    `ƒê√≥ng g√≥i (2.5%): ${formatCurrency(packagingFee)} ƒë`,
                    `Chi ph√≠ kh√°c (2%): ${formatCurrency(otherFee)} ƒë`,
                    `L∆∞∆°ng nh√¢n vi√™n (${salaryFee}%): ${formatCurrency(salaryFeeAmount)} ƒë`
                ];
            }
            
let netRevenue = 0;

if (currentPlatform === 'shopee') {
    const paymentFee = gi√°SauVoucher * 0.0491;
    const fixedFee = gi√°SauVoucher * 0.0884;
    const voucherXtraFee = gi√°SauVoucher * 0.03;
    const contentXtraFee = gi√°SauVoucher * 0.0295;
    const infraFee = 3000;
    const pishipFee = 1650;

    const hasVoucherXtra = isVoucherXtraChecked;
    const hasContentXtra = isContentXtraChecked;

if (hasVoucherXtra && hasContentXtra) {
    netRevenue = gi√°SauVoucher - paymentFee - fixedFee - voucherXtraFee - infraFee - pishipFee;
} else if (hasVoucherXtra) {
    netRevenue = gi√°SauVoucher - paymentFee - fixedFee - voucherXtraFee - infraFee - pishipFee;
} else if (hasContentXtra) {
    netRevenue = gi√°SauVoucher - paymentFee - fixedFee - contentXtraFee - infraFee - pishipFee;
} else {
    netRevenue = gi√°SauVoucher - paymentFee - fixedFee - infraFee - pishipFee;
}


} else if (currentPlatform === 'tiktok') {
    const transactionFee = gi√°SauVoucher * 0.05;
    const commissionFee = gi√°SauVoucher * 0.10;
    const dayType = document.querySelector('input[name="day-type"]:checked').value;
    const voucherRate = dayType === 'normal' ? 0.02 : 0.03;
    const hasVoucherXtraTikTok = document.getElementById('tiktok-voucher-xtra')?.checked;
    const voucherXtraFee = hasVoucherXtraTikTok ? gi√°SauVoucher * voucherRate : 0;

    netRevenue = gi√°SauVoucher - transactionFee - commissionFee - voucherXtraFee;
}

const profit = netRevenue - (costPrice * orderCount) - totalOperationFee;  // (sai v√¨ ƒëang tr·ª´ c·∫£ operationFee l·∫´n cost x order)
            const totalFee = totalPlatformFee + totalOperationFee;
const platformFeeRatio = (netRevenue > 0) ? (totalPlatformFee / netRevenue) * 100 : 0;
const operationFeeRatio = (netRevenue > 0) ? (totalOperationFee / netRevenue) * 100 : 0;
            
            // Update display
            document.getElementById('platform-fee').textContent = formatCurrency(totalPlatformFee) + ' ƒë';
            document.getElementById('operation-fee').textContent = formatCurrency(totalOperationFee) + ' ƒë';

            const netRevenueElement = document.getElementById('net-revenue');
            netRevenueElement.textContent = formatCurrency(netRevenue) + ' ƒë';
            netRevenueElement.className = netRevenue >= 0 ? 'text-xl font-bold text-blue-600' : 'text-xl font-bold text-red-600';
            
            const profitElement = document.getElementById('profit');
            profitElement.textContent = formatCurrency(profit) + ' ƒë';
            profitElement.className = profit >= 0 ? 'text-xl font-bold text-green-600' : 'text-xl font-bold text-red-600';
            
const platformFeeRatioEl = document.getElementById('platform-fee-ratio');
const operationFeeRatioEl = document.getElementById('operation-fee-ratio');

const platformFeeRatioText = isNaN(platformFeeRatio) ? 0 : platformFeeRatio;
const operationFeeRatioText = isNaN(operationFeeRatio) ? 0 : operationFeeRatio;

platformFeeRatioEl.textContent = platformFeeRatioText.toFixed(2) + '%';
operationFeeRatioEl.textContent = operationFeeRatioText.toFixed(2) + '%';

platformFeeRatioEl.className = 'text-lg font-semibold ' + getRatioColorClass(platformFeeRatioText);
operationFeeRatioEl.className = 'text-lg font-semibold ' + getRatioColorClass(operationFeeRatioText);
            
            // Update fee breakdown
const breakdown = document.getElementById('fee-breakdown');
breakdown.innerHTML = `
    <div class="mb-3">
        <strong class="text-gray-800">Ph√≠ n·ªÅn t·∫£ng ${currentPlatform.toUpperCase()}:</strong>
        ${platformFeeDetails.map(detail => `<div class="ml-4">‚Ä¢ ${detail}</div>`).join('')}
${(currentPlatform === 'shopee' && isVoucherXtraChecked && isContentXtraChecked) 
  ? `<div class="ml-4 text-sm text-red-600 italic mt-1">* Ch·ªâ t√≠nh m·ªôt trong hai ph√≠: Voucher Xtra ho·∫∑c Content Xtra</div>` 
  : ''}
    </div>
    <div>
        <strong class="text-gray-800">Ph√≠ v·∫≠n h√†nh:</strong>
        ${operationFeeDetails.map(detail => `<div class="ml-4">‚Ä¢ ${detail}</div>`).join('')}
    </div>
`;

// Khi ng∆∞·ªùi d√πng tick ho·∫∑c b·ªè tick c√°c checkbox ‚Üí t√≠nh l·∫°i k·∫øt qu·∫£
document.getElementById('voucher-xtra')?.addEventListener('change', calculateResult);
document.getElementById('content-xtra')?.addEventListener('change', calculateResult);
const tiktokVoucherCheckbox = document.getElementById('tiktok-voucher-xtra');
const tiktokDayType = document.getElementById('tiktok-day-type');

tiktokVoucherCheckbox?.addEventListener('change', () => {
    if (tiktokVoucherCheckbox.checked) {
if (document.getElementById('tiktok-voucher-xtra')?.checked) {
    tiktokDayType.classList.remove('hidden');
} else {
    tiktokDayType.classList.add('hidden');
}
    } else {
        tiktokDayType.classList.add('hidden');
    }
    calculateResult(); // c·∫≠p nh·∫≠t l·∫°i k·∫øt qu·∫£
});
        }
        
        function resetResults() {
            document.getElementById('platform-fee').textContent = '0 ƒë';
            document.getElementById('operation-fee').textContent = '0 ƒë';
            document.getElementById('net-revenue').textContent = '0 ƒë';
            document.getElementById('profit').textContent = '0 ƒë';
            document.getElementById('fee-ratio').textContent = '0%';
            document.getElementById('fee-breakdown').innerHTML = '';
        }
        
// K√≠ch ho·∫°t visual ch·ªçn cho c√°c n√∫t radio
function setupToggleButtons(name) {
  const inputs = document.querySelectorAll(`input[name="${name}"]`);
  const labels = document.querySelectorAll(`label[for^="${name}"]`);
  inputs.forEach(radio => {
    radio.addEventListener('change', () => {
      labels.forEach(label => label.classList.remove('active'));
      const targetLabel = document.querySelector(`label[for="${radio.id}"]`);
      targetLabel.classList.add('active');
    });
  });
}

// G·ªçi h√†m n√†y sau khi DOM ƒë√£ render
setupToggleButtons('shopee-xtra');
setupToggleButtons('tiktok-xtra');


// Initialize
selectPlatform('shopee'); // ho·∫∑c 'tiktok' n·∫øu b·∫°n mu·ªën kh·ªüi t·∫°o TikTok tr∆∞·ªõc

// S·ª± ki·ªán ·∫©n/hi·ªán ph·∫ßn ch·ªçn ng√†y TikTok d·ª±a v√†o checkbox
const tiktokVoucherCheckbox = document.getElementById('tiktok-voucher-xtra');
const tiktokDayType = document.getElementById('tiktok-day-type');

tiktokVoucherCheckbox?.addEventListener('change', () => {
    if (tiktokVoucherCheckbox.checked) {
        tiktokDayType.classList.remove('hidden');
    } else {
        tiktokDayType.classList.add('hidden');
    }
    calculateResult(); // c·∫≠p nh·∫≠t k·∫øt qu·∫£ ngay khi ƒë·ªïi
});


    </script>
</body>
</html>
